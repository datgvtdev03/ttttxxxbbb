<!-- <!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tài Xỉu - Game Online</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e, #16213e);
            color: white;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(90deg, #ff6b35, #f7931e);
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .header h1 {
            font-size: 2rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .game-board {
            background: linear-gradient(145deg, #1e1e1e, #2d2d2d);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.7);
            border: 2px solid #333;
            margin-bottom: 20px;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .session-info {
            display: flex;
            gap: 30px;
        }

        .info-item {
            text-align: center;
        }

        .info-label {
            font-size: 0.9rem;
            color: #ccc;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #fff;
        }

        .countdown {
            font-size: 2rem;
            font-weight: bold;
            color: #ff6b35;
            text-shadow: 0 0 10px rgba(255,107,53,0.5);
        }

        .dice-area {
            text-align: center;
            margin-bottom: 30px;
        }

        .dice-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .dice {
            width: 100px;
            height: 100px;
            background: linear-gradient(145deg, #fff, #e0e0e0);
            border-radius: 15px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            padding: 10px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            position: relative;
            transition: all 0.3s ease;
        }

        .dice-dot {
            width: 12px;
            height: 12px;
            background: #333;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .dice-dot.active {
            opacity: 1;
        }

        .dice[data-value="1"] .dice-dot:nth-child(5) { opacity: 1; }
        
        .dice[data-value="2"] .dice-dot:nth-child(3) { opacity: 1; }
        .dice[data-value="2"] .dice-dot:nth-child(7) { opacity: 1; }
        
        .dice[data-value="3"] .dice-dot:nth-child(3) { opacity: 1; }
        .dice[data-value="3"] .dice-dot:nth-child(5) { opacity: 1; }
        .dice[data-value="3"] .dice-dot:nth-child(7) { opacity: 1; }
        
        .dice[data-value="4"] .dice-dot:nth-child(1) { opacity: 1; }
        .dice[data-value="4"] .dice-dot:nth-child(3) { opacity: 1; }
        .dice[data-value="4"] .dice-dot:nth-child(7) { opacity: 1; }
        .dice[data-value="4"] .dice-dot:nth-child(9) { opacity: 1; }
        
        .dice[data-value="5"] .dice-dot:nth-child(1) { opacity: 1; }
        .dice[data-value="5"] .dice-dot:nth-child(3) { opacity: 1; }
        .dice[data-value="5"] .dice-dot:nth-child(5) { opacity: 1; }
        .dice[data-value="5"] .dice-dot:nth-child(7) { opacity: 1; }
        .dice[data-value="5"] .dice-dot:nth-child(9) { opacity: 1; }
        
        .dice[data-value="6"] .dice-dot:nth-child(1) { opacity: 1; }
        .dice[data-value="6"] .dice-dot:nth-child(3) { opacity: 1; }
        .dice[data-value="6"] .dice-dot:nth-child(4) { opacity: 1; }
        .dice[data-value="6"] .dice-dot:nth-child(6) { opacity: 1; }
        .dice[data-value="6"] .dice-dot:nth-child(7) { opacity: 1; }
        .dice[data-value="6"] .dice-dot:nth-child(9) { opacity: 1; }

        .dice.rolling {
            animation: diceRoll 2s ease-in-out;
        }

        @keyframes diceRoll {
            0%, 100% { transform: rotateX(0deg) rotateY(0deg); }
            25% { transform: rotateX(180deg) rotateY(90deg); }
            50% { transform: rotateX(360deg) rotateY(180deg); }
            75% { transform: rotateX(540deg) rotateY(270deg); }
        }

        .total-display {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 5px 15px rgba(255,107,53,0.3);
        }

        .total-number {
            font-size: 3rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .result-label {
            font-size: 1.5rem;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .betting-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .bet-option {
            background: linear-gradient(145deg, #2d2d2d, #1e1e1e);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .bet-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        }

        .bet-option.selected {
            border-color: #ff6b35;
            box-shadow: 0 0 20px rgba(255,107,53,0.5);
        }

        .bet-tai {
            background: linear-gradient(145deg, #ff416c, #ff4b2b);
        }

        .bet-xiu {
            background: linear-gradient(145deg, #4facfe, #00f2fe);
        }

        .bet-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .bet-range {
            font-size: 1.2rem;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .bet-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .stat-value {
            font-size: 1.1rem;
            font-weight: bold;
        }

        .bet-amount-section {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .bet-amount-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-align: center;
            color: #ff6b35;
        }

        .amount-options {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .amount-btn {
            background: linear-gradient(145deg, #333, #222);
            border: none;
            border-radius: 8px;
            color: white;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: bold;
        }

        .amount-btn:hover {
            background: linear-gradient(145deg, #ff6b35, #f7931e);
            transform: translateY(-2px);
        }

        .amount-btn.selected {
            background: linear-gradient(145deg, #ff6b35, #f7931e);
            box-shadow: 0 0 10px rgba(255,107,53,0.5);
        }

        .balance-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding: 10px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
        }

        .balance-info {
            display: flex;
            gap: 20px;
        }

        .balance-item {
            text-align: center;
        }

        .balance-label {
            font-size: 0.9rem;
            color: #ccc;
        }

        .balance-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #4CAF50;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .action-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .bet-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .bet-btn:hover {
            background: linear-gradient(45deg, #45a049, #4CAF50);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76,175,80,0.3);
        }

        .bet-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        .cancel-btn {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
        }

        .cancel-btn:hover {
            background: linear-gradient(45deg, #d32f2f, #f44336);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(244,67,54,0.3);
        }

        .history-section {
            background: linear-gradient(145deg, #1e1e1e, #2d2d2d);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid #333;
            box-shadow: 0 10px 30px rgba(0,0,0,0.7);
        }

        .history-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            color: #ff6b35;
        }

        .history-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 10px;
            max-height: 200px;
            overflow-y: auto;
        }

        .history-item {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            font-size: 0.9rem;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .history-item.tai {
            background: linear-gradient(145deg, #ff416c, #ff4b2b);
        }

        .history-item.xiu {
            background: linear-gradient(145deg, #4facfe, #00f2fe);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }

        .notification.error {
            background: linear-gradient(45deg, #f44336, #d32f2f);
        }

        .notification.warning {
            background: linear-gradient(45deg, #ff9800, #f57c00);
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 10px;
            }
            
            .betting-section {
                grid-template-columns: 1fr;
            }
            
            .amount-options {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .dice {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }
            
            .session-info {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🎰 TÀI XỈU ONLINE 🎰</h1>
    </div>

    <div class="game-container">
        <div class="game-board">
            <div class="game-info">
                <div class="session-info">
                    <div class="info-item">
                        <div class="info-label">Phiên</div>
                        <div class="info-value" id="sessionId">#001</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Trạng thái</div>
                        <div class="info-value" id="gameStatus">Đang cược</div>
                    </div>
                </div>
                <div class="countdown" id="countdown">30</div>
            </div>

            <div class="dice-area">
                <div class="dice-container">
                    <div class="dice" id="dice1" data-value="0">
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                    </div>
                    <div class="dice" id="dice2" data-value="0">
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                    </div>
                    <div class="dice" id="dice3" data-value="0">
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                        <div class="dice-dot"></div>
                    </div>
                </div>
                <div class="total-display">
                    <div class="total-number" id="totalScore">0</div>
                    <div class="result-label" id="resultLabel">Hãy đặt cược</div>
                </div>
            </div>

            <div class="betting-section">
                <div class="bet-option bet-tai" id="betTai">
                    <div class="bet-title">TÀI</div>
                    <div class="bet-range">11 - 18 điểm</div>
                    <div class="bet-stats">
                        <div class="stat-item">
                            <div class="stat-label">Tỷ lệ</div>
                            <div class="stat-value">1:1</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Người chơi</div>
                            <div class="stat-value" id="taiPlayers">0</div>
                        </div>
                    </div>
                </div>
                <div class="bet-option bet-xiu" id="betXiu">
                    <div class="bet-title">XỈU</div>
                    <div class="bet-range">4 - 10 điểm</div>
                    <div class="bet-stats">
                        <div class="stat-item">
                            <div class="stat-label">Tỷ lệ</div>
                            <div class="stat-value">1:1</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Người chơi</div>
                            <div class="stat-value" id="xiuPlayers">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bet-amount-section">
                <div class="bet-amount-title">Chọn số tiền cược</div>
                <div class="amount-options">
                    <button class="amount-btn" data-amount="1000">1K</button>
                    <button class="amount-btn" data-amount="5000">5K</button>
                    <button class="amount-btn" data-amount="10000">10K</button>
                    <button class="amount-btn" data-amount="50000">50K</button>
                    <button class="amount-btn" data-amount="100000">100K</button>
                    <button class="amount-btn" data-amount="500000">500K</button>
                    <button class="amount-btn" data-amount="1000000">1M</button>
                    <button class="amount-btn" data-amount="5000000">5M</button>
                </div>
                <div class="balance-display">
                    <div class="balance-info">
                        <div class="balance-item">
                            <div class="balance-label">Số dư</div>
                            <div class="balance-value" id="userBalance">1,000,000</div>
                        </div>
                        <div class="balance-item">
                            <div class="balance-label">Đã cược</div>
                            <div class="balance-value" id="betAmount">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="action-btn bet-btn" id="placeBetBtn">Đặt cược</button>
                <button class="action-btn cancel-btn" id="cancelBetBtn">Hủy cược</button>
            </div>
        </div>

        <div class="history-section">
            <div class="history-title">📊 Lịch sử kết quả</div>
            <div class="history-list" id="historyList">
                <!-- History items will be added here -->
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        class TaiXiuGame {
            constructor() {
                this.balance = 1000000;
                this.currentBet = null;
                this.betAmount = 0;
                this.selectedAmount = 0;
                this.gamePhase = 'betting'; // betting, rolling, result
                this.countdown = 30;
                this.sessionId = 1;
                this.history = [];
                this.taiPlayers = 0;
                this.xiuPlayers = 0;
                
                this.initElements();
                this.initEventListeners();
                this.startCountdown();
                this.loadHistory();
            }

            initElements() {
                this.elements = {
                    dice1: document.getElementById('dice1'),
                    dice2: document.getElementById('dice2'),
                    dice3: document.getElementById('dice3'),
                    totalScore: document.getElementById('totalScore'),
                    resultLabel: document.getElementById('resultLabel'),
                    betTai: document.getElementById('betTai'),
                    betXiu: document.getElementById('betXiu'),
                    placeBetBtn: document.getElementById('placeBetBtn'),
                    cancelBetBtn: document.getElementById('cancelBetBtn'),
                    userBalance: document.getElementById('userBalance'),
                    betAmountDisplay: document.getElementById('betAmount'),
                    countdown: document.getElementById('countdown'),
                    gameStatus: document.getElementById('gameStatus'),
                    sessionId: document.getElementById('sessionId'),
                    historyList: document.getElementById('historyList'),
                    taiPlayers: document.getElementById('taiPlayers'),
                    xiuPlayers: document.getElementById('xiuPlayers'),
                    notification: document.getElementById('notification')
                };
            }

            initEventListeners() {
                this.elements.betTai.addEventListener('click', () => this.selectBet('tai'));
                this.elements.betXiu.addEventListener('click', () => this.selectBet('xiu'));
                this.elements.placeBetBtn.addEventListener('click', () => this.placeBet());
                this.elements.cancelBetBtn.addEventListener('click', () => this.cancelBet());

                document.querySelectorAll('.amount-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.selectAmount(parseInt(btn.dataset.amount)));
                });
            }

            selectBet(type) {
                if (this.gamePhase !== 'betting') return;
                
                this.currentBet = type;
                this.elements.betTai.classList.remove('selected');
                this.elements.betXiu.classList.remove('selected');
                
                if (type === 'tai') {
                    this.elements.betTai.classList.add('selected');
                } else {
                    this.elements.betXiu.classList.add('selected');
                }
            }

            selectAmount(amount) {
                if (this.gamePhase !== 'betting') return;
                
                this.selectedAmount = amount;
                document.querySelectorAll('.amount-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });
                
                document.querySelector(`[data-amount="${amount}"]`).classList.add('selected');
            }

            placeBet() {
                if (this.gamePhase !== 'betting') {
                    this.showNotification('Không thể đặt cược lúc này!', 'warning');
                    return;
                }
                
                if (!this.currentBet) {
                    this.showNotification('Vui lòng chọn Tài hoặc Xỉu!', 'warning');
                    return;
                }
                
                if (this.selectedAmount === 0) {
                    this.showNotification('Vui lòng chọn số tiền cược!', 'warning');
                    return;
                }
                
                if (this.selectedAmount > this.balance) {
                    this.showNotification('Số dư không đủ!', 'error');
                    return;
                }
                
                this.balance -= this.selectedAmount;
                this.betAmount = this.selectedAmount;
                
                if (this.currentBet === 'tai') {
                    this.taiPlayers++;
                } else {
                    this.xiuPlayers++;
                }
                
                this.updateDisplay();
                this.showNotification(`Đặt cược ${this.formatMoney(this.selectedAmount)} vào ${this.currentBet.toUpperCase()} thành công!`, 'success');
                
                this.elements.placeBetBtn.disabled = true;
            }

            cancelBet() {
                if (this.betAmount === 0) return;
                
                this.balance += this.betAmount;
                this.betAmount = 0;
                
                if (this.currentBet === 'tai') {
                    this.taiPlayers--;
                } else {
                    this.xiuPlayers--;
                }
                
                this.currentBet = null;
                this.selectedAmount = 0;
                
                this.elements.betTai.classList.remove('selected');
                this.elements.betXiu.classList.remove('selected');
                document.querySelectorAll('.amount-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });
                
                this.elements.placeBetBtn.disabled = false;
                this.updateDisplay();
                this.showNotification('Đã hủy cược!', 'warning');
            }

            startCountdown() {
                const timer = setInterval(() => {
                    this.countdown--;
                    this.elements.countdown.textContent = this.countdown;
                    
                    if (this.countdown <= 5) {
                        this.elements.countdown.style.color = '#ff4444';
                    }
                    
                    if (this.countdown <= 0) {
                        clearInterval(timer);
                        this.rollDice();
                    }
                }, 1000);
            }

            rollDice() {
                this.gamePhase = 'rolling';
                this.elements.gameStatus.textContent = 'Đang lắc';
                this.elements.resultLabel.textContent = 'Đang lắc xúc xắc...';
                
                // Disable betting
                this.elements.placeBetBtn.disabled = true;
                this.elements.cancelBetBtn.disabled = true;
                
                // Animation
                this.elements.dice1.classList.add('rolling');
                this.elements.dice2.classList.add('rolling');
                this.elements.dice3.classList.add('rolling');
                
                // Rolling animation
                let rollCount = 0;
                const rollInterval = setInterval(() => {
                    this.elements.dice1.textContent = Math.floor(Math.random() * 6) + 1;
                    this.elements.dice2.textContent = Math.floor(Math.random() * 6) + 1;
                    this.elements.dice3.textContent = Math.floor(Math.random() * 6) + 1;
                    
                    rollCount++;
                    if (rollCount >= 30) {
                        clearInterval(rollInterval);
                        this.showResult();
                    }
                }, 100);
            }

            showResult() {
                // Final result
                const dice1 = Math.floor(Math.random() * 6) + 1;
                const dice2 = Math.floor(Math.random() * 6) + 1;
                const dice3 = Math.floor(Math.random() * 6) + 1;
                const total = dice1 + dice2 + dice3;
                
                this.elements.dice1.textContent = dice1;
                this.elements.dice2.textContent = dice2;
                this.elements.dice3.textContent = dice3;
                this.elements.totalScore.textContent = total;
                
                // Remove rolling animation
                this.elements.dice1.classList.remove('rolling');
                this.elements.dice2.classList.remove('rolling');
                this.elements.dice3.classList.remove('rolling');
                
                const isTai = total >= 11;
                const result = isTai ? 'tai' : 'xiu';
                
                this.elements.resultLabel.textContent = isTai ? 'TÀI' : 'XỈU';
                this.gamePhase = 'result';
                this.elements.gameStatus.textContent = 'Kết thúc';
                
                // Check win/lose
                if (this.betAmount > 0 && this.currentBet) {
                    if (this.currentBet === result) {
                        const winAmount = this.betAmount * 2;
                        this.balance += winAmount;
                        this.showNotification(`Chúc mừng! Bạn thắng ${this.formatMoney(winAmount)}!`, 'success');
                    } else {
                        this.showNotification(`Rất tiếc! Bạn thua ${this.formatMoney(this.betAmount)}!`, 'error');
                    }
                }
                
                // Add to history
                this.addToHistory(total, result);
                
                // Reset for next round
                setTimeout(() => {
                    this.nextRound();
                }, 5000);
            }

            nextRound() {
                this.sessionId++;
                this.countdown = 30;
                this.gamePhase = 'betting';
                this.currentBet = null;
                this.betAmount = 0;
                this.selectedAmount = 0;
                this.taiPlayers = Math.floor(Math.random() * 50) + 10;
                this.xiuPlayers = Math.floor(Math.random() * 50) + 10;
                
                this.elements.dice1.textContent = '?';
                this.elements.dice2.textContent = '?';
                this.elements.dice3.textContent = '?';
                this.elements.totalScore.textContent = '0';
                this.elements.resultLabel.textContent = 'Hãy đặt cược';
                this.elements.gameStatus.textContent = 'Đang cược';
                this.elements.sessionId.textContent = '#' + this.sessionId.toString().padStart(3, '0');
                this.elements.countdown.style.color = '#ff6b35';
                
                this.elements.betTai.classList.remove('selected');
                this.elements.betXiu.classList.remove('selected');
                document.querySelectorAll('.amount-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });
                
                this.elements.placeBetBtn.disabled = false;
                this.elements.cancelBetBtn.disabled = false;
                
                this.updateDisplay();
                this.startCountdown();
            }

            addToHistory(total, result) {
                this.history.unshift({ total, result });
                if (this.history.length > 20) {
                    this.history.pop();
                }
                
                this.updateHistory();
            }

            updateHistory() {
                this.elements.historyList.innerHTML = '';
                this.history.forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = `history-item ${item.result}`;
                    historyItem.innerHTML = `
                        <div>${item.total}</div>
                        <div style="font-size: 0.8rem;">${item.result.toUpperCase()}</div>
                    `;
                    this.elements.historyList.appendChild(historyItem);
                });
            }

            loadHistory() {
                // Generate some initial history
                for (let i = 0; i < 10; i++) {
                    const total = Math.floor(Math.random() * 15) + 4;
                    const result = total >= 11 ? 'tai' : 'xiu';
                    this.history.push({ total, result });
                }
                this.updateHistory();
            }

            updateDisplay() {
                this.elements.userBalance.textContent = this.formatMoney(this.balance);
                this.elements.betAmountDisplay.textContent = this.formatMoney(this.betAmount);
                this.elements.taiPlayers.textContent = this.taiPlayers;
                this.elements.xiuPlayers.textContent = this.xiuPlayers;
            }

            formatMoney(amount) {
                return amount.toLocaleString('vi-VN') + ' đ';
            }

            showNotification(message, type = 'success') {
                this.elements.notification.textContent = message;
                this.elements.notification.className = `notification ${type}`;
                this.elements.notification.classList.add('show');
                
                setTimeout(() => {
                    this.elements.notification.classList.remove('show');
                }, 3000);
            }
        }

        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new TaiXiuGame();
        });
    </script> -->



<!-- <!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <title>Game Tài Xỉu</title>
  <style>
    :root {
      --bg: #1e1e2f;
      --primary: #facc15;
      --secondary: #3b82f6;
      --accent: #ef4444;
      --white: #f9fafb;
      --green: #10b981;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--white);
      text-align: center;
      margin: 0;
      padding: 30px;
    }

    h1 {
      color: var(--primary);
      font-size: 32px;
      margin-bottom: 10px;
    }

    .money {
      font-size: 20px;
      margin-bottom: 10px;
    }

    .board {
      position: relative;
      width: 200px;
      height: 200px;
      margin: 30px auto;
    }

    .plate {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #ccc;
      position: relative;
      z-index: 1;
      overflow: hidden;
    }

    .cover {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #555;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      transition: all 0.5s ease-in-out;
      cursor: pointer;
    }

    .cover.open {
      transform: translateY(-250px);
    }

    .dice {
      width: 40px;
      height: 40px;
      background: white;
      color: black;
      border-radius: 8px;
      font-size: 20px;
      line-height: 40px;
      text-align: center;
      position: absolute;
      animation: roll 0.5s ease-in-out;
    }

    @keyframes roll {
      0% {
        transform: rotate(0deg) scale(1);
      }

      50% {
        transform: rotate(720deg) scale(1.2);
      }

      100% {
        transform: rotate(1440deg) scale(1);
      }
    }

    .bet-group,
    .bet-amounts {
      margin: 20px 0;
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .bet-button,
    .bet-amount-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background: var(--secondary);
      color: white;
      font-weight: bold;
      cursor: pointer;
    }

    .bet-button.active,
    .bet-amount-btn.active {
      background: var(--primary);
      color: black;
    }

    .bet-button.win {
      border: 3px solid var(--accent);
      background-color: #fee2e2;
      color: var(--accent);
    }

    #countdown {
      font-size: 20px;
      margin-top: 20px;
      color: var(--primary);
      transition: color 0.3s ease-in-out;
    }

    #history {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .history-item {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #fff;
      border: 2px solid #444;
    }

    .history-item.tai {
      background: black;
    }

    .history-item.xiu {
      background: white;
    }

    .mode-toggle {
      margin-top: 10px;
      background: #666;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
    }

    .mode-toggle.active {
      background: var(--green);
    }

    .cover {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #555;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      cursor: grab;
      transition: top 0.2s;
      user-select: none;
    }

    .cover.dragging {
      cursor: grabbing;
    }

    .dice {
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 6px;
      position: absolute;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 2px;
      padding: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      transform-origin: center;
    }

    .dot {
      width: 8px;
      height: 8px;
      background: black;
      border-radius: 50%;
      align-self: center;
      justify-self: center;
    }

    .bet-amount-btn.active {
  background: var(--primary);
  color: black;
}

  </style>
</head>

<body>
  <h1>🎲 Tài Xỉu</h1>
  <div class="money">Số dư: <span id="money">500000</span> đ</div>

  <div class="board">
    <div class="plate" id="plate"></div>
    <div class="cover" id="cover" onclick="handleCoverClick()"></div>
  </div>

  <div id="countdown">⏳ Thời gian còn lại: 10 giây</div>
  <button id="modeBtn" class="mode-toggle" onclick="toggleAutoMode()">🖐️</button>

  <div class="bet-group">
    <button class="bet-button" data-type="tai" onclick="placeBet(this)" style="width: 200px;">TÀI <div id="bet-tai"></div></button>
    <button class="bet-button" data-type="xiu" onclick="placeBet(this)" style="width: 200px;">XỈU <div id="bet-xiu"></div></button>
  </div>

  

  <div class="bet-amounts">
    <button class="bet-amount-btn" data-amount="1000" onclick="selectAmount(1000)">1.000</button>
    <button class="bet-amount-btn" data-amount="5000" onclick="selectAmount(5000)">5.000</button>
    <button class="bet-amount-btn" data-amount="10000" onclick="selectAmount(10000)">10.000</button>
    <button class="bet-amount-btn" data-amount="50000" onclick="selectAmount(50000)">50.000</button>
    <button class="bet-amount-btn" data-amount="100000" onclick="selectAmount(100000)">100.000</button>
    <button class="bet-amount-btn" data-amount="500000" onclick="selectAmount(500000)">500.000</button>
    <button class="bet-amount-btn" data-amount="1000000" onclick="selectAmount(1000000)">1.000.000</button>
    <button class="bet-amount-btn" data-amount="5000000" onclick="selectAmount(5000000)">5.000.000</button>
    <button class="bet-amount-btn" data-amount="50000000" onclick="selectAmount(50000000)">50.000.000</button>
    <button class="bet-amount-btn" data-amount="all" onclick="selectAmount(playerMoney)">All In</button>
  </div>

  <div>
    <h3>Lịch sử:</h3>
    <div id="history"></div>
  </div>

  <script>
    let playerMoney = 500000000;
    let selectedAmount = 1000;
    let bets = { tai: 0, xiu: 0 };
    let countdown = 10;
    let interval = null;
    let diceResult = [];
    let resultType = "";
    let readyToReveal = false;
    let history = [];
    let autoOpen = false;

    let isDragging = false;
    let startX = 0, startY = 0;
    let currentLeft = 0, currentTop = 0;

    cover.addEventListener("mousedown", (e) => {
      if (!readyToReveal) return;
      isDragging = true;
      startX = e.clientX;
      startY = e.clientY;
      cover.classList.add("dragging");
    });

    document.addEventListener("mousemove", (e) => {
      if (!isDragging) return;

      const deltaX = e.clientX - startX;
      const deltaY = e.clientY - startY;

      // Giới hạn di chuyển trong phạm vi đĩa
      let newLeft = Math.max(-180, Math.min(180, deltaX));
      let newTop = Math.max(-180, Math.min(180, deltaY));

      currentLeft = newLeft;
      currentTop = newTop;

      cover.style.left = newLeft + "px";
      cover.style.top = newTop + "px";

      // Nếu kéo đủ xa → tự mở
      if ((Math.abs(newTop) > 150 || Math.abs(newLeft) > 150) && readyToReveal) {
        finalizeReveal();
      }
    });

    document.addEventListener("mouseup", () => {
      if (!isDragging) return;
      isDragging = false;
      cover.classList.remove("dragging");

      // Nếu chưa mở hoàn toàn, trả về giữa
      if (Math.abs(currentLeft) < 150 && Math.abs(currentTop) < 150) {
        cover.style.left = "0px";
        cover.style.top = "0px";
      }
    });


    function finalizeReveal() {
      readyToReveal = false;
      cover.style.top = "-250px";
      cover.style.left = "0px";

      // TÍNH THẮNG THUA
      document.querySelectorAll(".bet-button").forEach(btn => {
        const type = btn.dataset.type;
        if (type === resultType) {
          btn.classList.add("win");
          if (bets[type]) playerMoney += bets[type] * 2;
        }
      });

      // LỊCH SỬ
      history.unshift(resultType);
      if (history.length > 20) history.pop();
      renderHistory();

      // CHUYỂN SANG VÁN MỚI
      setTimeout(() => {
        resetRound();
        startGame();
      }, 5000); // => 5 giây sau ván mới
    }


    function updateUI() {
      document.getElementById("money").innerText = playerMoney.toLocaleString();
      document.getElementById("bet-tai").innerText = bets.tai > 0 ? bets.tai.toLocaleString() + " đ" : "";
      document.getElementById("bet-xiu").innerText = bets.xiu > 0 ? bets.xiu.toLocaleString() + " đ" : "";
    }

    function selectAmount(amount) {
  selectedAmount = amount;

  document.querySelectorAll(".bet-amount-btn").forEach(btn => {
    const amt = btn.dataset.amount;
    if ((amt === "all" && amount === playerMoney) || parseInt(amt) === amount) {
      btn.classList.add("active");
    } else {
      btn.classList.remove("active");
    }
  });
}


    function placeBet(btn) {
      const type = btn.dataset.type;
      if (playerMoney < selectedAmount) return alert("Không đủ tiền");
      bets[type] += selectedAmount;
      playerMoney -= selectedAmount;
      btn.classList.add("active");
      updateUI();
    }

    function toggleAutoMode() {
      autoOpen = !autoOpen;
      const btn = document.getElementById("modeBtn");
      btn.innerText = autoOpen ? "🖐️❌" : "🖐️";
      btn.classList.toggle("active", autoOpen);
    }

    function startGame() {
      countdown = 10;
      document.getElementById("countdown").innerText = `⏳ Thời gian còn lại: ${countdown} giây`;
      interval = setInterval(() => {
        countdown--;
        document.getElementById("countdown").innerText = `⏳ Thời gian còn lại: ${countdown} giây`;
        if (countdown <= 0) {
          clearInterval(interval);
          prepareResult();
        }
      }, 1000);
    }

    function prepareResult() {
      diceResult = [roll(), roll(), roll()];
      const sum = diceResult.reduce((a, b) => a + b, 0);
      resultType = sum >= 11 ? "tai" : "xiu";
      readyToReveal = true;

      // VẼ XÚC XẮC NGAY BÂY GIỜ
      drawDice(diceResult);

      document.getElementById("countdown").innerText = autoOpen
        ? "🧠 Đang mở kết quả..."
        : "🕹 Kéo nắp để xem kết quả!";
      if (autoOpen) setTimeout(() => finalizeReveal(), 1000);
    }


    function handleCoverClick() {}

    function revealResult() {
      drawDice(diceResult);
      document.querySelectorAll(".bet-button").forEach(btn => {
        const type = btn.dataset.type;
        if (type === resultType) {
          btn.classList.add("win");
          if (bets[type]) playerMoney += bets[type] * 2;
        }
      });
      history.unshift(resultType);
      if (history.length > 20) history.pop();
      renderHistory();
      setTimeout(() => {
        resetRound();
        startGame();
      }, 4000);
    }

    function roll() {
      return Math.floor(Math.random() * 6) + 1;
    }

    function drawDice(dice) {
      const plate = document.getElementById("plate");
      plate.innerHTML = "";
      const placed = []; // chứa các viên đã đặt

      dice.forEach((value) => {
        const d = document.createElement("div");
        d.className = "dice";

        // Vị trí ngẫu nhiên nhưng không đè nhau
        let tries = 0;
        let left, top;
        do {
          left = Math.random() * 120 + 20;
          top = Math.random() * 120 + 20;
          tries++;
        } while (
          placed.some(p => getDistance(left, top, p.left, p.top) < 50) && tries < 100
        );

        placed.push({ left, top });

        const angle = Math.floor(Math.random() * 360);
        d.style.left = `${left}px`;
        d.style.top = `${top}px`;
        d.style.transform = `rotate(${angle}deg)`;

        const dotPositions = {
          1: [4],
          2: [0, 8],
          3: [0, 4, 8],
          4: [0, 2, 6, 8],
          5: [0, 2, 4, 6, 8],
          6: [0, 2, 3, 5, 6, 8]
        };

        for (let i = 0; i < 9; i++) {
          const dot = document.createElement("div");
          if (dotPositions[value].includes(i)) dot.className = "dot";
          d.appendChild(dot);
        }

        plate.appendChild(d);
      });
    }

    // Hàm tính khoảng cách 2 điểm
    function getDistance(x1, y1, x2, y2) {
      return Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
    }



    function renderHistory() {
      const div = document.getElementById("history");
      div.innerHTML = "";
      history.forEach(r => {
        const el = document.createElement("div");
        el.className = `history-item ${r}`;
        div.appendChild(el);
      });
    }

    function resetRound() {
      bets = { tai: 0, xiu: 0 };
      document.querySelectorAll(".bet-button").forEach(btn => btn.classList.remove("active", "win"));
      document.getElementById("cover").classList.remove("open");
      cover.style.top = "0px";
      cover.style.left = "0px";
      readyToReveal = false;
      updateUI();
    }


    // Bắt đầu game
    updateUI();
    selectAmount(1000);
    startGame();
  </script>
</body>

</html> -->



<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <title>Game Tài Xỉu</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');
    
    :root {
      --primary-red: #ff4757;
      --primary-blue: #2f3542;
      --accent-gold: #ffd700;
      --bg-dark: #1a1a2e;
      --bg-light: #16213e;
      --text-white: #ffffff;
      --text-gray: #a4a4a4;
      --success-green: #2ed573;
      --warning-orange: #ff6b35;
      --border-gray: #3a3a3a;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-light) 100%);
      color: var(--text-white);
      min-height: 100vh;
      overflow-x: hidden;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      padding: 20px 0;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      margin-bottom: 30px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .header h1 {
      font-size: 2.5rem;
      background: linear-gradient(45deg, var(--accent-gold), #ffed4a);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .balance {
      font-size: 1.2rem;
      color: var(--accent-gold);
      font-weight: 500;
    }

    .game-area {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 30px;
      margin-bottom: 30px;
    }

    .main-game {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      padding: 30px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
    }

    .board {
      position: relative;
      width: 300px;
      height: 300px;
      margin: 0 auto 30px;
      background: radial-gradient(circle, #2c3e50, #34495e);
      border-radius: 50%;
      border: 5px solid var(--accent-gold);
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
    }

    .plate {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle, #ecf0f1, #bdc3c7);
      position: relative;
      z-index: 1;
      overflow: hidden;
      border: 3px solid #34495e;
    }

    .cover {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: linear-gradient(135deg, #2c3e50, #34495e);
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
      cursor: grab;
      transition: all 0.3s ease;
      user-select: none;
      border: 3px solid #1a252f;
      box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
      touch-action: none;
    }

    .cover::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 60px;
      height: 60px;
      background: var(--accent-gold);
      border-radius: 50%;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    }

    .cover.dragging {
      cursor: grabbing;
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
    }

    .dice {
      width: 50px;
      height: 50px;
      background: linear-gradient(145deg, #ffffff, #f0f0f0);
      border-radius: 8px;
      position: absolute;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 2px;
      padding: 6px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      transform-origin: center;
      border: 2px solid #ddd;
    }

    .dot {
      width: 8px;
      height: 8px;
      background: #333;
      border-radius: 50%;
      align-self: center;
      justify-self: center;
    }

    .countdown {
      text-align: center;
      font-size: 1.5rem;
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(255, 71, 87, 0.1);
      border-radius: 10px;
      border: 1px solid var(--primary-red);
      color: var(--primary-red);
      font-weight: 500;
    }

    .bet-section {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
    }

    .bet-button {
      flex: 1;
      padding: 20px;
      border: none;
      border-radius: 15px;
      font-size: 1.5rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    .bet-button[data-type="tai"] {
      background: linear-gradient(135deg, var(--primary-red), #ff3838);
      color: white;
      box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3);
    }

    .bet-button[data-type="xiu"] {
      background: linear-gradient(135deg, var(--primary-blue), #1e2a3a);
      color: white;
      box-shadow: 0 4px 15px rgba(47, 53, 66, 0.3);
    }

    .bet-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }

    .bet-button.active {
      transform: scale(1.05);
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
      border: 2px solid var(--accent-gold);
    }

    .bet-button.win {
      animation: winPulse 1s infinite;
    }

    @keyframes winPulse {
      0%, 100% { transform: scale(1.05); }
      50% { transform: scale(1.1); }
    }

    .bet-amount {
      text-align: center;
      font-size: 1.1rem;
      margin-top: 10px;
      color: var(--accent-gold);
      font-weight: 500;
    }

    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .mode-toggle {
      background: linear-gradient(135deg, var(--success-green), #26d0ce);
      color: white;
      border: none;
      padding: 15px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .mode-toggle:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(46, 213, 115, 0.3);
    }

    .mode-toggle.active {
      background: linear-gradient(135deg, var(--warning-orange), #ff5722);
    }

    .bet-amounts {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .bet-amounts h3 {
      grid-column: 1 / -1;
      text-align: center;
      margin-bottom: 10px;
      color: var(--accent-gold);
      font-size: 1.2rem;
    }

    .bet-amount-btn {
      padding: 12px 8px;
      border: none;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-white);
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-size: 0.9rem;
    }

    .bet-amount-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-1px);
    }

    .bet-amount-btn.active {
      background: linear-gradient(135deg, var(--accent-gold), #ffed4a);
      color: var(--bg-dark);
      border-color: var(--accent-gold);
      font-weight: 700;
    }

    .history-section {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .history-section h3 {
      text-align: center;
      margin-bottom: 15px;
      color: var(--accent-gold);
      font-size: 1.2rem;
    }

    .history {
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .history-item {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .history-item.tai {
      background: linear-gradient(135deg, var(--primary-red), #ff3838);
      color: white;
      border-color: var(--primary-red);
    }

    .history-item.xiu {
      background: linear-gradient(135deg, var(--primary-blue), #1e2a3a);
      color: white;
      border-color: var(--primary-blue);
    }

    .history-item:hover {
      transform: scale(1.1);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .game-area {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .bet-amounts {
        grid-template-columns: repeat(3, 1fr);
      }
      
      .board {
        width: 250px;
        height: 250px;
      }
      
      .header h1 {
        font-size: 2rem;
      }
    }

    /* Animations */
    @keyframes roll {
      0% { transform: rotate(0deg) scale(1); }
      50% { transform: rotate(720deg) scale(1.2); }
      100% { transform: rotate(1440deg) scale(1); }
    }

    .dice {
      animation: roll 0.6s ease-in-out;
    }

    /* Glowing effects */
    .board {
      position: relative;
    }

    .board::before {
      content: '';
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      background: conic-gradient(var(--accent-gold), var(--primary-red), var(--primary-blue), var(--accent-gold));
      border-radius: 50%;
      z-index: -1;
      animation: rotate 3s linear infinite;
      opacity: 0.3;
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>🎲 TÀI XỈU ONLINE</h1>
      <div class="balance">💰 Số dư: <span id="money">500,000,000</span> VNĐ</div>
    </div>

    <div class="game-area">
      <div class="main-game">
        <div class="board">
          <div class="plate" id="plate"></div>
          <div class="cover" id="cover"></div>
        </div>

        <div class="countdown" id="countdown">⏳ Thời gian còn lại: 10 giây</div>

        <div class="bet-section">
          <button class="bet-button" data-type="tai" onclick="placeBet(this)">
            <div>TÀI (11-18)</div>
            <div class="bet-amount" id="bet-tai"></div>
          </button>
          <button class="bet-button" data-type="xiu" onclick="placeBet(this)">
            <div>XỈU (3-10)</div>
            <div class="bet-amount" id="bet-xiu"></div>
          </button>
        </div>
      </div>

      <div class="sidebar">
        <button id="modeBtn" class="mode-toggle" onclick="toggleAutoMode()">
          🖐️ Chế độ thủ công
        </button>

        <div class="bet-amounts">
          <h3>💎 Chọn mức cược</h3>
          <button class="bet-amount-btn" data-amount="1000" onclick="selectAmount(1000)">1K</button>
          <button class="bet-amount-btn" data-amount="5000" onclick="selectAmount(5000)">5K</button>
          <button class="bet-amount-btn" data-amount="10000" onclick="selectAmount(10000)">10K</button>
          <button class="bet-amount-btn" data-amount="50000" onclick="selectAmount(50000)">50K</button>
          <button class="bet-amount-btn" data-amount="100000" onclick="selectAmount(100000)">100K</button>
          <button class="bet-amount-btn" data-amount="500000" onclick="selectAmount(500000)">500K</button>
          <button class="bet-amount-btn" data-amount="1000000" onclick="selectAmount(1000000)">1M</button>
          <button class="bet-amount-btn" data-amount="5000000" onclick="selectAmount(5000000)">5M</button>
          <button class="bet-amount-btn" data-amount="50000000" onclick="selectAmount(50000000)">50M</button>
          <button class="bet-amount-btn" data-amount="all" onclick="selectAmount(playerMoney)">All In</button>
        </div>

        <div class="history-section">
          <h3>📊 Lịch sử kết quả</h3>
          <div class="history" id="history"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let playerMoney = 500000000;
    let selectedAmount = 1000;
    let bets = { tai: 0, xiu: 0 };
    let countdown = 10;
    let interval = null;
    let diceResult = [];
    let resultType = "";
    let readyToReveal = false;
    let history = [];
    let autoOpen = false;

    let isDragging = false;
    let startX = 0, startY = 0;
    let currentLeft = 0, currentTop = 0;

    const cover = document.getElementById('cover');

    // Mouse events
    cover.addEventListener("mousedown", (e) => {
      if (!readyToReveal) return;
      isDragging = true;
      startX = e.clientX;
      startY = e.clientY;
      cover.classList.add("dragging");
      e.preventDefault();
    });

    document.addEventListener("mousemove", (e) => {
      if (!isDragging) return;

      const deltaX = e.clientX - startX;
      const deltaY = e.clientY - startY;

      let newLeft = Math.max(-180, Math.min(180, deltaX));
      let newTop = Math.max(-180, Math.min(180, deltaY));

      currentLeft = newLeft;
      currentTop = newTop;

      cover.style.left = newLeft + "px";
      cover.style.top = newTop + "px";

      if ((Math.abs(newTop) > 150 || Math.abs(newLeft) > 150) && readyToReveal) {
        finalizeReveal();
      }
    });

    document.addEventListener("mouseup", () => {
      if (!isDragging) return;
      isDragging = false;
      cover.classList.remove("dragging");

      if (Math.abs(currentLeft) < 150 && Math.abs(currentTop) < 150) {
        cover.style.left = "0px";
        cover.style.top = "0px";
      }
    });

    // Touch events for mobile
    cover.addEventListener("touchstart", (e) => {
      if (!readyToReveal) return;
      isDragging = true;
      const touch = e.touches[0];
      startX = touch.clientX;
      startY = touch.clientY;
      cover.classList.add("dragging");
      e.preventDefault();
    });

    document.addEventListener("touchmove", (e) => {
      if (!isDragging) return;

      const touch = e.touches[0];
      const deltaX = touch.clientX - startX;
      const deltaY = touch.clientY - startY;

      let newLeft = Math.max(-180, Math.min(180, deltaX));
      let newTop = Math.max(-180, Math.min(180, deltaY));

      currentLeft = newLeft;
      currentTop = newTop;

      cover.style.left = newLeft + "px";
      cover.style.top = newTop + "px";

      if ((Math.abs(newTop) > 150 || Math.abs(newLeft) > 150) && readyToReveal) {
        finalizeReveal();
      }
      e.preventDefault();
    });

    document.addEventListener("touchend", () => {
      if (!isDragging) return;
      isDragging = false;
      cover.classList.remove("dragging");

      if (Math.abs(currentLeft) < 150 && Math.abs(currentTop) < 150) {
        cover.style.left = "0px";
        cover.style.top = "0px";
      }
    });

    document.addEventListener("mousemove", (e) => {
      if (!isDragging) return;

      const deltaX = e.clientX - startX;
      const deltaY = e.clientY - startY;

      // Giới hạn di chuyển trong phạm vi đĩa
      let newLeft = Math.max(-180, Math.min(180, deltaX));
      let newTop = Math.max(-180, Math.min(180, deltaY));

      currentLeft = newLeft;
      currentTop = newTop;

      cover.style.left = newLeft + "px";
      cover.style.top = newTop + "px";

      // Nếu kéo đủ xa → tự mở
      if ((Math.abs(newTop) > 150 || Math.abs(newLeft) > 150) && readyToReveal) {
        finalizeReveal();
      }
    });

    document.addEventListener("mouseup", () => {
      if (!isDragging) return;
      isDragging = false;
      cover.classList.remove("dragging");

      // Nếu chưa mở hoàn toàn, trả về giữa
      if (Math.abs(currentLeft) < 150 && Math.abs(currentTop) < 150) {
        cover.style.left = "0px";
        cover.style.top = "0px";
      }
    });

    function finalizeReveal() {
      readyToReveal = false;
      cover.style.top = "-250px";
      cover.style.left = "0px";

      document.querySelectorAll(".bet-button").forEach(btn => {
        const type = btn.dataset.type;
        if (type === resultType) {
          btn.classList.add("win");
          if (bets[type]) playerMoney += bets[type] * 2;
        }
      });

      history.unshift(resultType);
      if (history.length > 20) history.pop();
      renderHistory();

      setTimeout(() => {
        resetRound();
        startGame();
      }, 5000);
    }

    function updateUI() {
      document.getElementById("money").innerText = playerMoney.toLocaleString();
      document.getElementById("bet-tai").innerText = bets.tai > 0 ? bets.tai.toLocaleString() + " VNĐ" : "";
      document.getElementById("bet-xiu").innerText = bets.xiu > 0 ? bets.xiu.toLocaleString() + " VNĐ" : "";
    }

    function selectAmount(amount) {
      selectedAmount = amount;

      document.querySelectorAll(".bet-amount-btn").forEach(btn => {
        const amt = btn.dataset.amount;
        if ((amt === "all" && amount === playerMoney) || parseInt(amt) === amount) {
          btn.classList.add("active");
        } else {
          btn.classList.remove("active");
        }
      });
    }

    function placeBet(btn) {
      const type = btn.dataset.type;
      if (playerMoney < selectedAmount) return alert("Không đủ tiền!");
      bets[type] += selectedAmount;
      playerMoney -= selectedAmount;
      btn.classList.add("active");
      updateUI();
    }

    function toggleAutoMode() {
      autoOpen = !autoOpen;
      const btn = document.getElementById("modeBtn");
      btn.innerHTML = autoOpen ? "🤖 Chế độ tự động" : "🖐️ Chế độ thủ công";
      btn.classList.toggle("active", autoOpen);
    }

    function startGame() {
      countdown = 10;
      document.getElementById("countdown").innerHTML = `⏳ Thời gian còn lại: ${countdown} giây`;
      interval = setInterval(() => {
        countdown--;
        document.getElementById("countdown").innerHTML = `⏳ Thời gian còn lại: ${countdown} giây`;
        if (countdown <= 0) {
          clearInterval(interval);
          prepareResult();
        }
      }, 1000);
    }

    function prepareResult() {
      diceResult = [roll(), roll(), roll()];
      const sum = diceResult.reduce((a, b) => a + b, 0);
      resultType = sum >= 11 ? "tai" : "xiu";
      readyToReveal = true;

      drawDice(diceResult);

      document.getElementById("countdown").innerHTML = autoOpen
        ? "🤖 Đang mở kết quả..."
        : "🎯 Kéo nắp để xem kết quả!";
      if (autoOpen) setTimeout(() => finalizeReveal(), 1000);
    }

    function roll() {
      return Math.floor(Math.random() * 6) + 1;
    }

    function drawDice(dice) {
      const plate = document.getElementById("plate");
      plate.innerHTML = "";
      const placed = [];

      dice.forEach((value) => {
        const d = document.createElement("div");
        d.className = "dice";

        let tries = 0;
        let left, top;
        do {
          left = Math.random() * 200 + 25;
          top = Math.random() * 200 + 25;
          tries++;
        } while (
          placed.some(p => getDistance(left, top, p.left, p.top) < 60) && tries < 100
        );

        placed.push({ left, top });

        const angle = Math.floor(Math.random() * 360);
        d.style.left = `${left}px`;
        d.style.top = `${top}px`;
        d.style.transform = `rotate(${angle}deg)`;

        const dotPositions = {
          1: [4],
          2: [0, 8],
          3: [0, 4, 8],
          4: [0, 2, 6, 8],
          5: [0, 2, 4, 6, 8],
          6: [0, 2, 3, 5, 6, 8]
        };

        for (let i = 0; i < 9; i++) {
          const dot = document.createElement("div");
          if (dotPositions[value].includes(i)) dot.className = "dot";
          d.appendChild(dot);
        }

        plate.appendChild(d);
      });
    }

    function getDistance(x1, y1, x2, y2) {
      return Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
    }

    function renderHistory() {
      const div = document.getElementById("history");
      div.innerHTML = "";
      history.forEach(r => {
        const el = document.createElement("div");
        el.className = `history-item ${r}`;
        el.textContent = r === 'tai' ? 'T' : 'X';
        div.appendChild(el);
      });
    }

    function resetRound() {
      bets = { tai: 0, xiu: 0 };
      document.querySelectorAll(".bet-button").forEach(btn => btn.classList.remove("active", "win"));
      cover.style.top = "0px";
      cover.style.left = "0px";
      readyToReveal = false;
      updateUI();
    }

    // Khởi tạo game
    updateUI();
    selectAmount(1000);
    startGame();
  </script>
</body>

</html>
